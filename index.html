<!DOCTYPE html>
<html lang="de">

<head>
    <meta charset="UTF-8">
    <title>Fordy's SideStore-Repo</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="assets/style.css">
    <link rel="icon" type="image/png" href="https://heyfordy.de/assets/icon.png">
    <link rel="stylesheet" type="text/css" href="https://rr.heyfordy.de/assets/Rubik.css">
    <link rel="stylesheet" href="https://heyfordy.de/assets/bootstrap.min.css">
</head>

<body>
    <div class="container text-center">
        <div class="header-box">
            <img src="https://heyfordy.de/assets/Fordy.png" alt="heyFordy" class="logo-main" />
            <div class="backdrop sidestore"></div>
            <h2 class="repo-title">SideStore-Repo</h2>
        </div>

        <div class="button-group">
                    <button onclick="location.href='sidestore://source?url=https://repo.heyfordy.de/apps.json'" 
                    type="button" class="btn btn-outline-primary btn-action mt-3">+ ADD SOURCE</button>
            <br><br>
      
            <button onclick="location.href='https://repo.heyfordy.de/server/SideStore.ipa'" 
                    type="button" class="btn btn-outline-light btn-action">üñ•Ô∏è ¬ª DOWNLOAD SideServer (Win)</button>
            <button onclick="location.href='=https://repo.heyfordy.de/server/SideServer.Installer.msi'" 
                    type="button" class="btn btn-outline-light btn-action">üíæ ‚Ä¢ DOWNLOAD SIDESTORE .ipa</button>

        </div>

        <hr class="separator">

        <div class="preview-section">
            <h3 class="section-title">Preview - Apps in my repo:</h3>
            <div id="app-preview-container" class="preview-grid">
                <p>Loading apps...</p>
            </div>
            <button onclick="location.href='viewer/view/?source=https://repo.heyfordy.de/apps.json'" 
                    class="btn btn-sm btn-link text-white-50 mt-3">Full Repo Viewer</button>
        </div>

        <hr class="separator">

        <div class="footer-buttons">
            <button onclick="location.href='https://heyfordy.de'" 
                    type="button" class="btn btn-outline-light btn-footer">üåé heyFordy.de</button>
        </div>
    </div>

    <script>
        async function fetchRepoPreview() {
            const container = document.getElementById('app-preview-container');
            try {
                const response = await fetch('apps.json');
                const repo = await response.json();
                
                container.innerHTML = '';
                // Render top 4 apps for a clean preview
                repo.apps.slice(0, 4).forEach(app => {
                    const appEl = document.createElement('div');
                    appEl.className = 'preview-card';
                    appEl.innerHTML = `
                        <img src="${app.iconURL}" alt="${app.name}">
                        <div class="preview-card-content">
                            <h4>${app.name}</h4>
                            <p>${app.subtitle || 'No description'}</p>
                        </div>
                    `;
                    container.appendChild(appEl);
                });
            } catch (e) {
                container.innerHTML = '<p class="text-danger">Preview load failed.</p>';
            }
        }
        document.addEventListener('DOMContentLoaded', fetchRepoPreview);
    </script>
</body>
</html>